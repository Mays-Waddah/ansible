---
- name: Install database server  and initialize
  hosts: all
  gather_facts: false
  become: true
  tasks:
    - name: Download foo.conf
      ansible.builtin.get_url:
        url: https://dev.mysql.com/get/mysql80-community-release-el8-1.noarch.rpm
        dest: /etc/mysql.conf
        mode: '0440'
 
   - name: Install a list of packages (suitable replacement for 2.11 loop deprecation warning)
     ansible.builtin.yum:
       name:
           mysql80-community-release
       state: present
        
- ---
- name: MariaDB
  hosts: all
  gather_facts: true
  become: true
  vars:
    mysql_root_password: "Password1"
  tasks:
    - name: install mariadb
      yum:
        name:
          - mariadb-server
          - python3-PyMySQL
        state: latest
    - name: start mariadb
      service:
        name: mariadb
        enabled: true
        state: started
    - name: mysql_root_password
      mysql_user:
        login_user: root
        login_password: "{{ mysql_root_password }}"
        user: root
        check_implicit_admin: true
        password: "{{ mysql_root_password }}"
        host: localhost
    - name: remove remote root
      mysql_user:
        check_implicit_admin: true
        login_user: root
        login_password: "{{ mysql_root_password }}"
        user: root
        host: "{{ ansible_fqdn }}"
        state: absent

        state: latest
    - name: Ensure mysql service is running
      ansible.builtin.systemd
        name: mysqld
        state: restarted
        enabled: yes





--------------------####------------------------
    - name: Install Required pip modules
      ansible.builtin.pip:
        name: PyMySQL
        state: present
        executable: pip3

    - name: Ensure mysql service is running
      ansible.builtin.systemd
        name: mysqld
        state: restarted
        enabled: yes

   
    - name: Add .my.cnf to user home
      template:
        src: my.cnf.j2
        dest: /root/.my.cnf

  
    
   

  
